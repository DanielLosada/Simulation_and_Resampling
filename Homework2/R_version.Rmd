# Exercise 1

```{r}
simulate_T <- function(n) {
  U <- runif(n)  # Generate n uniform random numbers
  T <- 2 / (1 - U)^(1/3)  # Apply inverse transform
  return(T)
}

# Example usage
set.seed(123)
samples <- simulate_T(10000)

# Plot histogram
hist(samples, probability = TRUE, col = "lightblue", breaks = 50, main = "Simulated Samples from F_T(t)", xlab = "T")

# Overlay theoretical density (Derivative of CDF)
curve(6 * (2^3) / x^4, from = 2, to = max(samples), add = TRUE, col = "red", lwd = 2)

```

```{r}
library(Rcpp)

cppFunction('
NumericVector simulate_T_rcpp(int n) {
  NumericVector U = runif(n);  // Generate uniform samples
  NumericVector T = 2 / pow(1 - U, 1.0 / 3.0);  // Apply inverse transform
  return T;
}
')

# Example usage
set.seed(123)
samples_rcpp <- simulate_T_rcpp(10000)

# Verify by histogram
hist(samples_rcpp, probability = TRUE, col = "lightblue", breaks = 50, main = "Simulated Samples from F_T(t) - Rcpp", xlab = "T")
curve(6 * (2^3) / x^4, from = 2, to = max(samples_rcpp), add = TRUE, col = "red", lwd = 2)

```

# Exercise 2

```{r}
library(ggplot2)

### Part (a): Determine M such that f_S(t) â‰¤ M f_T(t) ###
f_S <- function(t) { 8 / t^5 }  # PDF of S ~ Pareto(2,4)
f_T <- function(t) { 6 / t^4 }  # PDF of T ~ Pareto(2,3)

# Compute M
M <- max((f_S(2) / f_T(2)))  # Maximized at t = 2
cat("(a) M =", M, "\n")  # Should output M = 2/3

### Part (b): Rejection Sampling Algorithm ###
# Function to sample from Pareto(2,3) using inverse transform sampling
rpareto_T <- function(n) {
  U <- runif(n)
  return(2 / (U^(1/3)))  # Inverse CDF
}

# Acceptance-rejection sampling for S ~ Pareto(2,4)
rpareto_S <- function(n) {
  samples <- numeric(n)
  count <- 0
  while (count < n) {
    T <- rpareto_T(1)  # Sample T ~ Pareto(2,3)
    U <- runif(1)
    if (U <= 2 / T) {  # Acceptance condition
      count <- count + 1
      samples[count] <- T
    }
  }
  return(samples)
}

### Part (c): Monte Carlo Estimation of E[S] and Confidence Interval ###
set.seed(123)
MC <- 10000
samples_S <- rpareto_S(MC)

# Compute expected value
E_S <- mean(samples_S)
cat("(c) Estimated E[S]:", E_S, "\n")

# Compute 99% confidence interval
alpha <- 0.01
se <- sd(samples_S) / sqrt(MC)
CI <- c(E_S - qnorm(1 - alpha/2) * se, E_S + qnorm(1 - alpha/2) * se)
cat("(c) 99% Confidence Interval: [", CI[1], ",", CI[2], "]\n")

# Plot histogram with theoretical density
ggplot(data.frame(S = samples_S), aes(x = S)) +
  geom_histogram(aes(y = ..density..), bins = 50, fill = "lightblue", color = "black", alpha = 0.7) +
  stat_function(fun = f_S, color = "red", lwd = 1.2) +
  labs(title = "Simulated Samples from Pareto(2,4)", x = "S", y = "Density") +
  theme_minimal()

```